<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Form</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container border border-primary rounded">
    <h2 class="my-4">Job Form</h2>
    <form id="jobForm">

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <h3>Client details</h3>
                    <div class="name-input-group row-input">
                        <input type="text" id="firstName" class="form-control" placeholder="First Name" required="">
                        <input type="text" id="lastName" class="form-control" placeholder="Last Name" required="">
                    </div>
                    <input type="tel" id="phone" class="form-control" placeholder="Phone" required="">
                    <input type="email" id="email" class="form-control" placeholder="Email (optional)" required="">
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <h3>Job details</h3>
                    <div class="row-input">
                        <select id="jobType" class="form-control" required="">
                            <option value="">Job type</option>
                            <option value="type1">Type 1</option>
                            <option value="type2">Type 2</option>
                        </select>
                        <select id="jobSource" class="form-control" required="">
                            <option value="">Job source</option>
                            <option value="source1">Source 1</option>
                            <option value="source2">Source 2</option>
                        </select>
                    </div>


                    <textarea id="jobDescription" class="form-control"
                              placeholder="Job description (optional)"></textarea>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <h3>Service location</h3>
                    <input type="text" id="address" class="form-control" placeholder="Address" required="">
                    <input type="text" id="city" class="form-control" placeholder="City" required="">
                    <input type="text" id="state" class="form-control" placeholder="State" required="">
                    <div class="row-input">
                        <input type="text" id="zipCode" class="form-control" placeholder="Zip Code" required="">
                        <select id="area" class="form-control" required="">
                            <option value="">Area</option>
                            <option value="area1">Area 1</option>
                            <option value="area2">Area 2</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <h3>Scheduled</h3>
                    <input type="date" id="startDate" class="form-control" required="">
                    <div class="row-input">
                        <input type="time" id="startTime" class="form-control" placeholder="Enter time" required>
                        <input type="time" id="endTime" class="form-control" required="">
                    </div>
                    <select id="testSelect" class="form-control" required="">
                        <option value="">Test select</option>
                        <option value="test1">Test 1</option>
                        <option value="test2">Test 2</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary my-2">Submit</button>
        </div>

    </form>
</div>

<script>
    document.getElementById('jobForm').addEventListener('submit', function (event) {
        event.preventDefault();
        const deal = {
            title: document.getElementById('jobType').value + ' Job for ' + document.getElementById('firstName').value + ' ' + document.getElementById('lastName').value,
            value: 0,
            "b2215522686adff59b85d4e36c8852797da42323": document.getElementById('address').value,
            '5612170187979f10dfc9cff913476bab1eb4ef0e': document.getElementById('phone').value,
            "88ebdca0a075989afc14d2fd84c3d43caea7e9f3": document.getElementById('email').value,
            '468feac486ec3b824c4a406c9370666b155d3d25': document.getElementById('jobType').value,
            '3b09081bc662c208c929ab70df280cbe2013939b': document.getElementById('jobSource').value,
            '175f81a3044c66b3eb30da120b22c559fabb9590': document.getElementById('jobDescription').value,
            '05df333d4fbf13026708af36ecd5a6d0b765ff1a': document.getElementById('city').value,
            '8cbddb39156d53a3ebb9500ec317bab43c964ec7': document.getElementById('state').value,
            'fe326d7322e25510d695de633815dbcdbc654540': document.getElementById('zipCode').value,
            'e5ae71b95b8f5634f2f8e1edcda9699268a37a96': document.getElementById('area').value,
            '5b313fdaea5639ceeba98688d5bb70fa38aeda83': document.getElementById('startDate').value,
            '87235f371c08c1f5abf855b7b6acba9cdba0413e': document.getElementById('startTime').value,
            '93238d7a8dcc21c730b3cefbcf0bf447bcc39219': document.getElementById('endTime').value,
            '3766acea71bb9a31e0537a72464b99aebcff67a8': document.getElementById('testSelect').value

        };
        createPipedriveDeal(deal);
    });

    function createPipedriveDeal(deal) {
        const apiToken = '7826180059028272f44b8859fad8ec43dd15890d';
        const url = `https://api.pipedrive.com/v1/deals?api_token=${apiToken}`;

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(deal)
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Сделка успешно создана!');
                } else {
                    alert('Ошибка при создании сделки: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Ошибка:', error);
                alert('Ошибка при создании сделки: ' + error.message);
            });
    }
</script>
</body>
</html>
