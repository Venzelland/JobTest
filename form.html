<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Form</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container border border-primary rounded">
    <h2 class="my-4">Job Form</h2>
    <form id="jobForm">

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <h3>Client details</h3>
                    <div class="name-input-group row-input">
                        <input type="text" id="firstName" class="form-control" placeholder="First Name" required="">
                        <input type="text" id="lastName" class="form-control" placeholder="Last Name" required="">
                    </div>
                    <input type="tel" id="phone" class="form-control" placeholder="Phone" required="">
                    <input type="email" id="email" class="form-control" placeholder="Email (optional)" required="">
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <h3>Job details</h3>
                    <div class="row-input">
                        <select id="jobType" class="form-control" required="">
                            <option value="">Job type</option>
                            <option value="type1">Type 1</option>
                            <option value="type2">Type 2</option>
                        </select>
                        <select id="jobSource" class="form-control" required="">
                            <option value="">Job source</option>
                            <option value="source1">Source 1</option>
                            <option value="source2">Source 2</option>
                        </select>
                    </div>


                    <textarea id="jobDescription" class="form-control"
                              placeholder="Job description (optional)"></textarea>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <h3>Service location</h3>
                    <input type="text" id="address" class="form-control" placeholder="Address" required="">
                    <input type="text" id="city" class="form-control" placeholder="City" required="">
                    <input type="text" id="state" class="form-control" placeholder="State" required="">
                    <div class="row-input">
                        <input type="text" id="zipCode" class="form-control" placeholder="Zip Code" required="">
                        <select id="area" class="form-control" required="">
                            <option value="">Area</option>
                            <option value="area1">Area 1</option>
                            <option value="area2">Area 2</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <h3>Scheduled</h3>
                    <input type="date" id="startDate" class="form-control" required="">
                    <div class="row-input">
                        <input type="time" id="startTime" class="form-control" placeholder="Enter time" required>
                        <input type="time" id="endTime" class="form-control" required="">
                    </div>
                    <select id="testSelect" class="form-control" required="">
                        <option value="">Test select</option>
                        <option value="test1">Test 1</option>
                        <option value="test2">Test 2</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary my-2">Submit</button>
        </div>

    </form>
</div>

<script>
    document.getElementById('jobForm').addEventListener('submit', function (event) {
        event.preventDefault();
        const deal = {
            title: document.getElementById('jobType').value + ' Job for ' + document.getElementById('firstName').value + ' ' + document.getElementById('lastName').value,
            value: 0,
            "de9c744b418a1dd7917feccc6c154bd34d7ebfd6": document.getElementById('address').value,
            '7f2422b5d7a8883d5f69b0b3e647dcfa4a116dde': document.getElementById('phone').value,
            "e1f4e642e8c2e96ce6fc2f0a8a59a9d369390fea": document.getElementById('email').value,
            '23fd27b4373b591fb6cb7265b31073ceed4e2de0': document.getElementById('jobType').value,
            '1e8a6595a55c7e3cc1b1311b52826c624b3d75d2': document.getElementById('jobSource').value,
            '1106f371b301b4093fbd6471d6773474c06f5312': document.getElementById('jobDescription').value,
            'ff2bacbe72520108eab137e89940bd1e6db763d1': document.getElementById('city').value,
            'cd53d39c0be4656168ef9849a99d563595c37106': document.getElementById('state').value,
            '788afa403933474fd0392c1ae4b0aa30da6e0efc': document.getElementById('zipCode').value,
            '82d25fe7c2889022a43efc0d3e54f4d4c8e9ec81': document.getElementById('area').value,
            'e58b4c69da23f6ff7e7feac99ac3bd3639105800': document.getElementById('startDate').value,
            '3ff8fc36c133b75f15fe432b28c28bd5731876ea': document.getElementById('startTime').value,
            '4358232f36986a2ed11b395eddedaa2471ada3dc': document.getElementById('endTime').value,
            'f0820afac1b8a4b68d87078b5c86a91f5940ca59': document.getElementById('testSelect').value

        };
        createPipedriveDeal(deal);
    });

    function createPipedriveDeal(deal) {
        const apiToken = '376dde13fa759a67727f8719d4552e439b002355';
        const url = `https://api.pipedrive.com/v1/deals?api_token=${apiToken}`;

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(deal)
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Сделка успешно создана!');
                } else {
                    alert('Ошибка при создании сделки: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Ошибка:', error);
                alert('Ошибка при создании сделки: ' + error.message);
            });
    }
</script>
</body>
</html>
